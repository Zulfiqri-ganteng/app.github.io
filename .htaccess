# ----------------------------------------------------------------------
# ðŸ”’ KEAMANAN DAN PROTEKSI
# ----------------------------------------------------------------------

# Blokir akses ke file rahasia
<FilesMatch "\.(env|git|log|sql)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Hapus cache browser untuk file PHP
<FilesMatch "\.php$">
    FileETag None
    <IfModule mod_headers.c>
        Header unset ETag
        Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
        Header set Pragma "no-cache"
        Header set Expires "Wed, 11 Jan 1980 05:00:00 GMT"
    </IfModule>
</FilesMatch>

# ----------------------------------------------------------------------
# ðŸŒŸ MENGIKUTI FORMAT BARIS UNIFIK (LF)
# ----------------------------------------------------------------------

# Ubah CRLF menjadi LF untuk keseluruhan server
SetEnvIfNoCase Content-Type "^text/.*" force-response-crlf\n

# ----------------------------------------------------------------------
# ðŸ›  OTOMATIS HAPUS 'index.php' DARI URL
# ----------------------------------------------------------------------

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Jika folder aplikasi berada di subfolder (misalnya /app.sewaambulaneindonesia24jam.com)
    RewriteBase /app.sewaambulaneindonesia24jam.com/

    # Hindari mengakses direktori terlarang
    RewriteCond $1 ^(application|system|vendor) [NC]
    RewriteRule ^(.*)$ - [R=403,L]

    # Hilangkan index.php dari URL
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

# ----------------------------------------------------------------------
# ðŸ’¡ CATATAN
# ----------------------------------------------------------------------
# 1. Pastikan mod_rewrite aktif di server.
# 2. Ganti `/app.sewaambulaneindonesia24jam.com/` sesuai domain/subdomainmu.
# 3. Jangan lupa atur izin file:
#    chmod 644 .htaccess
#    chmod -R 755 application/system/vendor/uploads